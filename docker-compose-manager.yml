services:
  # Web Manager Service
  web-manager:
    build: .
    container_name: doc2pdf-web-manager
    ports:
      - "0.0.0.0:5000:5000"
    environment:
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - DEBUG_MODE=${DEBUG_MODE:-false}
      - DOCKER_HOST=unix:///var/run/docker.sock
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    restart: unless-stopped
    command: python web_manager.py
    networks:
      - doc2pdf-network
    privileged: true # Give Docker socket access

  # Bot Service (managed by web manager)
  # This will be created/managed by the web interface
  # bot:
  #   image: doc2pdf-bot
  #   container_name: doc2pdf-bot
  #   environment:
  #     - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
  #     - DEBUG_MODE=${DEBUG_MODE:-false}
  #   volumes:
  #     - ./debug_output:/app/debug_output
  #   restart: unless-stopped
  #   command: python bot_runner.py
  #   networks:
  #     - doc2pdf-network
  #   depends_on:
  #     - web-manager

networks:
  doc2pdf-network:
    driver: bridge

volumes:
  debug_output:
    driver: local
